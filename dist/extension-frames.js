!function(){"use strict";const e="single-file-response-fetch",t="text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8",r=window.fetch;function a(t){return new Promise(((r,a)=>{var s,i,n,o;s=new CustomEvent("single-file-request-fetch",{detail:t}),window.dispatchEvent(s),i=e,n=function s(i){var n,o,d;i.detail?i.detail.url==t&&(n=e,o=s,d=!1,window.removeEventListener(n,o,d),i.detail.response?r({status:i.detail.status,headers:new Map(i.detail.headers),arrayBuffer:async()=>i.detail.response}):a(i.detail.error)):a()},o=!1,window.addEventListener(i,n,o)}))}browser.runtime.onMessage.addListener((e=>{if("singlefile.fetchFrame"==e.method&&window.frameId&&window.frameId==e.frameId)return async function(e){try{let s=await r(e.url,{cache:"force-cache",headers:{accept:t}});return 401!=s.status&&403!=s.status&&404!=s.status||(s=await Promise.race([a(e.url),new Promise(((e,t)=>setTimeout((()=>t()),5e3)))])),{status:s.status,headers:[...s.headers],array:Array.from(new Uint8Array(await s.arrayBuffer()))}}catch(e){return{error:e&&e.toString()}}}(e)}))}();
